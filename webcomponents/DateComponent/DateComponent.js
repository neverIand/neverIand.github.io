import{fetchData}from"/scripts/fetchData.js";import{handleThemeChange}from"/scripts/theme.js";const CSS="\n:host {\n  display: block;\n}\ntime {\n  display: flex;\n  flex-direction: column;\n  color: var(--text-color);\n  font-style: italic;\n}\n",canConstruct="undefined"!=typeof CSSStyleSheet&&"function"==typeof CSSStyleSheet.prototype.replaceSync,canAdopt="undefined"!=typeof ShadowRoot&&"adoptedStyleSheets"in ShadowRoot.prototype;let sharedSheet;canConstruct&&(sharedSheet=new CSSStyleSheet,sharedSheet.replaceSync(CSS));class CustomDate extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"});if(canAdopt&&sharedSheet)t.adoptedStyleSheets=[sharedSheet];else{const e=document.createElement("style");e.textContent=CSS,t.appendChild(e)}document.addEventListener("berry-theme",(t=>handleThemeChange(t,this)))}connectedCallback(){this.render()}renderArticleDate(t){const e=this.shadowRoot.querySelector("time"),n=this.shadowRoot.getElementById("date");if(t&&t.date){if(e.setAttribute("datetime",t.date),n.textContent=t.date,t.lastUpdate){const n=document.createElement("span");n.textContent=`Last updated: ${t.lastUpdate}`,e.appendChild(n)}}else n.textContent="Unknown date"}render(){const t=this.getAttribute("datetime"),e=this.getAttribute("last-update"),n=document.createElement("template");n.innerHTML=`\n      <time datetime="${t}">\n        <span id="date">${t}</span>\n        ${e?`<span>Last updated: ${e}</span>`:""}\n      </time>\n  `,t||initArticleDate(this),this.shadowRoot.appendChild(n.content.cloneNode(!0))}}async function initArticleDate(t){const e=window.location.pathname.split("-");let n=e[0].endsWith("misc")?"/articles/misc/data/misc.json":"/articles/new/data/new.json";const a=await fetchData(n);if(a){const n=parseInt(e[1]),o=a.find((t=>t.id===n));t.renderArticleDate(o)}}customElements.get("berry-date")||customElements.define("berry-date",CustomDate);export default CustomDate;